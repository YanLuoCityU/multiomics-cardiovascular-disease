# AI-based multiomics profiling for personalized prediction of cardiovascular disease: A prospective UK Biobank study"

Code for the paper "AI-based multiomics profiling for personalized prediction of cardiovascular disease: A prospective UK Biobank study". This repository contains Python and R codes for data preprocessing, model training and evaluations, model interpretation, and visualization. Our demo website can be found [here](https://orthodox-binnie-hkuqpteam-9f6dd502.koyeb.app/).

## Project Structure and Usage Guidance

### 1. `data_loader/DataPreparation/`

This folder contains all code for preparing input features and outcomes, organized into:

- `OmicsGenerator/`: Scripts for extracting omics features (Metabolomics, Proteomics, PRS).
- `PredictorsGenerator/`: Scripts for generating clinical predictors.
- `OutcomesGenerator/`: Scripts for constructing outcome variables.

---

### 2. `data/processed/` and `data/split_seed-XXX/`

- Processed intermediate files (e.g., omics, covariates, outcomes) are stored in `data/processed/`.
- Dataset splits are generated by `data_loader/data_preparation.py`, and the resulting training, validation, and test sets are saved in `data/split_seed-XXX/` (with folder names indicating the random seed).

---

### 3. `model/hyperparameter_tuning/OmicsNet_optuna/` and `config/OmicsNet/`

- `OmicsNet_optuna/`: Uses Optuna to perform hyperparameter tuning for the OmicsNet models (MetNet and ProNet).
- The best hyperparameter configurations are saved in:
  - `config/OmicsNet/Metabolomics.json`
  - `config/OmicsNet/Proteomics.json`

---

### 4. `model/experiments/OmicsNet/`

After selecting the best hyperparameters:

- Use `metabolomics.py` and `proteomics.py` to train the MetNet and ProNet, respectively.
- This process computes the prediction scores (`MetScore`, `ProScore`) and feature importance using SHAP values.
- Trained models and results are saved under `saved/models/OmicsNet/` and `saved/results/`.

---

### 5. `model/baseline/`

This folder contains baseline models used for benchmarking against OmicsNet models.

---

### 6. `figures/` and `visualization/`

- `figures/`: Contains intermediate results used to generate figures for the manuscript (e.g., C-index comparisons, calibration curves, decision curves).
- `visualization/visualization.Rmd`: R Markdown script that produces final manuscript figures and tables based on data in the `figures/` directory.

---


## System requirements
All codes were originally processed using:

- System hardware:
  - Python version 3.8.5, Linux
  - R version 4.3.3, Windows 10 x64
&nbsp;
- Main softwares:
  - Python
    - scikit-learn v1.3.2
    - pytorch v1.11.0 (CUDA 11.3, cuDNN 8.2.0)
    - optuna v4.0.0
    - shap v0.46.0
    - lifelines v0.27.8
  - R  
    - data.table v1.15.4
    - dcurves v0.5.0
    - dplyr v1.1.4
    - forcats v1.0.0
    - ggbreak v0.1.2
    - ggforce v0.4.2
    - ggplot2 v3.5.1
    - ggpubr v0.6.0
    - ggsci v3.2.0
    - ggtext v0.1.2
    - geomtextpath v0.1.4
    - glue v1.8.0
    - gtsummary v2.0.3
    - jsonlite v1.8.8
    - lubridate v1.9.3
    - MetBrewer v0.2.0
    - paletteer v1.6.0  
    - patchwork v1.2.0  
    - purrr v1.0.2  
    - readr v2.1.5  
    - scales v1.3.0  
    - showtext v0.9-7  
    - showtextdb v3.0  
    - skimr v2.1.5  
    - stringr v1.5.1  
    - sysfonts v0.8.9  
    - tibble v3.2.1  
    - tictoc v1.2.1  
    - tidyr v1.3.1  
    - tidyverse v2.0.0  

## License
This project is available under the MIT license.

## Contact
Yan Luo - luo.yan@my.cityu.edu.hk